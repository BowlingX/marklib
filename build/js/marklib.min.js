!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Marklib=t():e.Marklib=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="../",t(0)}([function(e,t,n){e.exports=n(9)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.DATA_IS_SELECTION=t.ATTR_DATA_ORIGINAL_INDEX=void 0;var i=n(4),o=t.ATTR_DATA_ORIGINAL_INDEX="data-original-index",s=t.DATA_IS_SELECTION="data-is-selection",u=";";if(Element&&!Element.prototype.matches){var l=Element.prototype;l.matches=l.matchesSelector||l.mozMatchesSelector||l.msMatchesSelector||l.oMatchesSelector||l.webkitMatchesSelector}var f=function(){function e(){r(this,e)}return a(e,null,[{key:"nodeListFilter",value:function(e,t){return Array.prototype.filter.call(e||[],t)}},{key:"guid",value:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"nodeIsEmpty",value:function(e){return e.nodeValue.match(/^[\s]*$/g)}},{key:"index",value:function(e,t){var n=t||(e.nodeType===Node.TEXT_NODE?e.parentNode.childNodes:e.parentNode.children);return Array.prototype.indexOf.call(n||[],e)}},{key:"wrap",value:function(e,t){var n=e;if(!n)return t;n instanceof NodeList||n instanceof Array||(n=[n]);for(var r=n.length-1;r>=0;r--){var a=r>0?t.cloneNode(!0):t,i=n[r],o=i.parentNode,s=i.nextSibling;a.appendChild(i),s?o.insertBefore(a,s):o.appendChild(a)}return t}},{key:"calcIndex",value:function(t){for(var n=0,r=!1,a=t.parentNode.childNodes,i=a.length,s=0;i>s;s++){var u=a[s];if(u===t)break;var l=u.getAttribute?u.getAttribute(o):null;l&&(n=parseInt(l,10),r=!0),n++}return r?n:e.index(t)}},{key:"parents",value:function(t,n){return e.parentsCallback(t,function(e){return n&&(e===n||"string"==typeof n&&e.matches&&e.matches(n))?!0:n?!1:!0})}},{key:"parentsCallback",value:function(e,t){for(var n=e,r=[];null!==n.parentNode;)n=n.parentNode,t(n)&&r.push(n);return r}},{key:"parent",value:function(e,t){for(var n=e;null!==n.parentNode;)if(n=n.parentNode,n.matches&&n.matches(t))return n;return!1}},{key:"closest",value:function(t,n){return e.closestCallback(t,function(e){return e.matches&&e.matches(n)})}},{key:"closestCallback",value:function(e,t){for(var n=e;null!==n;){if(t(n))return n;n=n.parentNode}return!1}},{key:"outerMostCallback",value:function(e,t){for(var n=e,r=!1;null!==n;)t(n)&&(r=n),n=n.parentNode;return r}},{key:"isMarkNode",value:function(e){return e instanceof HTMLElement&&e.hasAttribute(s)}},{key:"getPath",value:function(t,n){for(var r=null,a=t,i=function(t){return!e.isMarkNode(t)&&t.nodeName===a.nodeName};a;){var s=null;if(Node.TEXT_NODE===a.nodeType){var l=e.parents(a,"["+o+"]").reverse()[0],f=0;l||(f=e.calcIndex(a));var c=l?parseInt(l.getAttribute(o),10):f;s=u+c}else s=a.nodeName;if(!s)break;s=s.toLowerCase();var d=a.parentNode;if(e.isMarkNode(a)){if(d!==n){a=d;continue}break}var h=e.nodeListFilter(d.children,i),p=e.index(a,h);if(h.length>1&&p>=0&&(s+=":nth-of-type("+(p+1)+")"),r=s+(r?">"+r:""),d===n)break;a=d}return r.replace("#document>","").replace(">;",";")}},{key:"findOriginalOffset",value:function(t){if(!t.parentNode.hasAttribute(i.ATTR_DATA_ORIGINAL_OFFSET_START))return 0;var n=e.parent(t,"["+i.ATTR_DATA_ORIGINAL_OFFSET_START+"]");return n?parseInt(n.getAttribute(i.ATTR_DATA_ORIGINAL_OFFSET_START),10):0}},{key:"deserializePath",value:function(t,n){var r=t.split(";"),a=r[0],s=parseInt(r[1],10),u=parseInt(r[2],10),l=a.trim()?n.querySelector(a):n,f=null;return e.walkTextNodes(l,function(t){var n=t.parentNode.getAttribute(i.ATTR_DATA_ORIGINAL_OFFSET_START);n=null===n?0:n;var r=t.parentNode.getAttribute(o);if(r=null===r?e.calcIndex(t):r,parseInt(r,10)===s&&u>=n&&parseInt(n,10)+t.length>=u){var a=t.parentNode.hasAttribute(i.ATTR_DATA_ORIGINAL_OFFSET_START)?u-parseInt(t.parentNode.getAttribute(i.ATTR_DATA_ORIGINAL_OFFSET_START),10):u;return f={node:t,offset:a},!1}return!0},null),f}},{key:"walkDom",value:function(e,t){var n,r=arguments.length<=2||void 0===arguments[2]?NodeFilter.SHOW_ALL:arguments[2],a=arguments.length<=3||void 0===arguments[3]?null:arguments[3];if(!e)return!1;var i=[e,r];a&&i.push(a);for(var o=(n=document).createTreeWalker.apply(n,i);o.nextNode();)if(!t(o.currentNode))return!0;return!1}},{key:"walkTextNodes",value:function(t,n){var r=arguments.length<=2||void 0===arguments[2]?{acceptNode:function(t){return!e.nodeIsEmpty(t)}}:arguments[2];return e.walkDom(t,n,NodeFilter.SHOW_TEXT,r)}},{key:"getIndexParentIfHas",value:function(e,t){var n=e.parentNode,r=parseInt(n.getAttribute(o),10);return r>t?r:t}},{key:"getOffsetParentIfHas",value:function(e){var t=e.parentNode,n=parseInt(t.getAttribute(i.ATTR_DATA_ORIGINAL_OFFSET_START),10);return n>0?n:0}}]),e}();t["default"]=f},,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_WRAPPED_NODE=t.ATTR_DATA_ORIGINAL_OFFSET_START=void 0;var u=n(1),l=r(u),f=n(5),c=r(f),d=n(6),h=r(d),p=n(1),v="x-marker",E=t.ATTR_DATA_ORIGINAL_OFFSET_START="data-original-offset-start",_="original-text-node-index",T="data-is-start-end",g="data-is-highlight-node",y="data-selection-id",N=16,b=t.EVENT_WRAPPED_NODE="wrapped-node",m=function(e){function t(e,n,r){a(this,t);var o=i(this,Object.getPrototypeOf(t).call(this,n,e));return o.id=l["default"].guid(),o.startContainer=null,o.endContainer=null,o.context=r||o.document,o._renderResult=null,o}return o(t,e),s(t,[{key:"getId",value:function(){return this.id}},{key:"setId",value:function(e){var t=this;return this.id=e,this._renderResult&&this.wrapperNodes.forEach(function(e){return e.setAttribute(y,t.id)}),this}},{key:"_createWrapTemplate",value:function(e){var n=this.document.createElement(v),r="true";return e||(n.className=this.options.className.join(" "),t.setMarklibInstance(n,this),this.wrapperNodes.push(n),n.setAttribute(g,r),n.setAttribute(y,this.getId())),n.setAttribute(p.DATA_IS_SELECTION,r),n}},{key:"_createStartEndWrapTemplate",value:function(e){var t=this._createWrapTemplate();return t.setAttribute(T,"true"),t.textContent=e,t}},{key:"_createStartOrEndContainer",value:function(e,t,n,r){var a=this._createStartEndWrapTemplate(t);return a.setAttribute(p.ATTR_DATA_ORIGINAL_INDEX,l["default"].getIndexParentIfHas(e,r)),a.setAttribute(E,n),a.setAttribute(_,r),a}},{key:"_createWrap",value:function(e,t,n,r,a){var i=n>=0?n:l["default"].calcIndex(e),o=this._createWrapTemplate(a);o.setAttribute(p.ATTR_DATA_ORIGINAL_INDEX,l["default"].getIndexParentIfHas(e,i));var s=t>=0?t:l["default"].getOffsetParentIfHas(e);o.setAttribute(E,s),o.setAttribute(_,i),r&&o.setAttribute(T,T);var u=l["default"].wrap(e,o);return this.emit(b,e,u),u}},{key:"_createSplitContainer",value:function(e,t,n){var r=this.document.createElement(v);return r.setAttribute(p.DATA_IS_SELECTION,"true"),r.setAttribute(p.ATTR_DATA_ORIGINAL_INDEX,l["default"].getIndexParentIfHas(e,t)),r.setAttribute(E,n),r.setAttribute(_,t),r}},{key:"walk",value:function(e,t,n){for(var r=e;r&&r!==n.parentNode;){var a=r;if(r=r.parentNode,this.wrapSiblings(a.nextSibling,t))break}}},{key:"wrapSiblings",value:function(e,n){for(var r=this,a=e,i=!1,o=function(e){var n=t.getMarklibInstance(e.parentNode);e.parentNode.hasAttribute(T)&&e.parentNode.hasAttribute(g)&&n===r?r._createWrap(e,void 0,void 0,void 0,!0):r._createWrap(e)},s=function(e){l["default"].nodeIsEmpty(e)||o(e)},u=function(e){return e===n?!1:(Node.TEXT_NODE===e.nodeType&&s(e),!0)},f=function(e){s(e)};null!==a&&a!==n;){var c=a;if(a=a.nextSibling,Node.TEXT_NODE===c.nodeType)s(c);else if(c.compareDocumentPosition(n)&N?(l["default"].walkDom(c,u),i=!0):l["default"].walkTextNodes(c,f),i)return!0}return i}},{key:"_markTextSameNode",value:function(e,t,n){var r=e.nodeValue,a=l["default"].calcIndex(e);if(!r)return!1;if(t>0){var i=r.slice(0,t);e.parentNode.insertBefore(this.document.createTextNode(i),e),l["default"].wrap(e.previousSibling,this._createSplitContainer(e,a,l["default"].getOffsetParentIfHas(e)))}if(n<r.length){var o=r.slice(n,r.length);e.parentNode.insertBefore(this.document.createTextNode(o),e.nextSibling),l["default"].wrap(e.nextSibling,this._createSplitContainer(e,a,l["default"].getOffsetParentIfHas(e)+n))}return e.nodeValue=r.slice(t,n),this.startContainer=this._createWrap(e,l["default"].getOffsetParentIfHas(e)+t,a,!0).parentNode,this.endContainer=this.startContainer,this.startContainer}},{key:"_markTextDifferentNode",value:function(e,t,n,r){var a=l["default"].calcIndex(e),i=l["default"].calcIndex(t),o=e.nodeValue,s=e;if(void 0!==o){var u=o.slice(n,o.length);e.nodeValue=o.slice(0,n);var f=l["default"].getOffsetParentIfHas(e);s=this._createStartOrEndContainer(e,u,f===n?f:f+n,a),e.parentNode.insertBefore(s,e.nextSibling),this.startContainer=s,e.nodeValue&&l["default"].wrap(e,this._createSplitContainer(e,a,l["default"].getOffsetParentIfHas(e)))}var c=t,d=t.nodeValue;if(void 0!==d){var h=d.slice(0,r);t.nodeValue=d.slice(r,d.length),c=this._createStartOrEndContainer(t,h,l["default"].getOffsetParentIfHas(t),i),t.parentNode.insertBefore(c,t),this.endContainer=c;var p=l["default"].getOffsetParentIfHas(t);l["default"].wrap(t,this._createSplitContainer(t,i,p===r?p:p+r))}return{startT:s,endT:c}}},{key:"_renderWithElements",value:function(e,t,n,r,a){if(this._renderResult)return this._renderResult;var i=e,o=t,s=a,u=l["default"].parents(i,n);u=u[u.length-1];var f=u?u:n,d=l["default"].findOriginalOffset(i),h=l["default"].findOriginalOffset(o);if(i.nodeType!==Node.TEXT_NODE&&o.nodeType!==Node.TEXT_NODE&&i===o&&(o=o.nextElementSibling||o),i.nodeType!==Node.TEXT_NODE&&l["default"].walkDom(i,function(e){return e.nodeType===Node.TEXT_NODE?(i=e,!1):!0}),o.nodeType!==Node.TEXT_NODE){var v=i;0===s&&(v=o.previousElementSibling||i);var _=l["default"].closest(v,":not(["+p.DATA_IS_SELECTION+"])").childNodes;if(_.length){var T=_[_.length-1];if(T.nodeType===Node.TEXT_NODE)o=T,s=T.length;else for(var g=T.lastChild;null!==g;)g&&g.nodeType===Node.TEXT_NODE&&(o=g,s=g.length,g.parentNode.hasAttribute(E)&&(s=parseInt(g.parentNode.getAttribute(E),10)+s)),g=g.lastChild}if(o.nodeType!==Node.TEXT_NODE)throw Error("Could not found endContainer, highlighting would be unstable")}return this._renderResult=new c["default"](d+r,h+s,l["default"].getPath(i,this.context),l["default"].getPath(o,this.context)),this._renderResult.instance=this,this._renderSelection(i,o,r,s,f,!!u),this._renderResult}},{key:"_renderSelection",value:function(e,t,n,r,a,i){if(e===t)this._markTextSameNode(e,n,r);else{var o=this._markTextDifferentNode(e,t,n,r),s=this.wrapperNodes.indexOf(o.endT);this.wrapperNodes.splice(s,1),i?this.walk(o.startT,t,a):this.wrapSiblings(o.startT.nextSibling,t),this.wrapperNodes.push(o.endT)}}},{key:"renderWithPath",value:function(e,t){var n=l["default"].deserializePath(e,this.context),r=l["default"].deserializePath(t,this.context);if(n&&r&&n.node&&r.node){var a=document.createRange();a.setStart(n.node,n.offset),a.setEnd(r.node,r.offset);var i=a.toString(),o=this.renderWithRange(a);return o.text=i,i}throw new Error("Could not find start- and/or end-container in document")}},{key:"renderWithResult",value:function(e){return this.renderWithPath(e.startContainerPath+";"+e.startOffset,e.endContainerPath+";"+e.endOffset)}},{key:"renderWithRange",value:function(e){var t=e.toString(),n=this._renderWithElements(e.startContainer,e.endContainer,e.commonAncestorContainer,e.startOffset,e.endOffset);return n.text=t,n}},{key:"destroy",value:function(){this.wrapperNodes.forEach(function(e){delete e.marklibInstance,e.className=""}),this.removeEvent()}},{key:"result",get:function(){return this._renderResult}}],[{key:"setMarklibInstance",value:function(e,t){return e.marklibInstance=t,e}},{key:"getMarklibInstance",value:function(e){return e?e.marklibInstance:null}}]),t}(h["default"]);t["default"]=m},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,r,a,i){n(this,e),this.startOffset=t,this.endOffset=r,this.startContainerPath=a,this.endContainerPath=i,this._renderingInstance=null}return r(e,[{key:"serialize",value:function(){return{startOffset:this.startOffset,endOffset:this.endOffset,startContainerPath:this.startContainerPath,endContainerPath:this.endContainerPath}}},{key:"text",set:function(e){this._text=e},get:function(){return this._text}},{key:"instance",get:function(){return this._renderingInstance},set:function(e){this._renderingInstance=e}}],[{key:"fromObject",value:function(t){return new e(t.startOffset,t.endOffset,t.startContainerPath,t.endContainerPath)}}]),e}();t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_PART_TREE_LEAVE=t.EVENT_PART_TREE_ENTER=t.EVENT_MOUSELEAVE=t.EVENT_MOUSEENTER=t.EVENT_CLICK=void 0;var f=n(10),c=r(f),d=n(4),h=r(d),p=n(1),v=r(p),E=t.EVENT_CLICK="click",_=t.EVENT_MOUSEENTER="hover-enter",T=t.EVENT_MOUSELEAVE="hover-leave",g=t.EVENT_PART_TREE_ENTER="tree-enter",y=t.EVENT_PART_TREE_LEAVE="tree-leave",N=function(e){function t(e,n){i(this,t);var r=o(this,Object.getPrototypeOf(t).call(this));return r.options={hoverClass:"marklib--hover",treeClass:"marklib--tree",className:["marking"]},r.options=Object.assign(r.options,e||{}),"string"==typeof r.options.className&&(r.options.className=r.options.className.split(" ")),r.wrapperNodes=[],r._registerEvents(n),r.document=n,r}return s(t,e),l(t,[{key:"_registerEvents",value:function(e){var t=this;this.on(_,function(){t.wrapperNodes.forEach(function(e){e.classList.add(t.options.hoverClass)})}),this.on(T,function(){t.wrapperNodes.forEach(function(e){e.classList.remove(t.options.hoverClass)})}),this.on(g,function(){t.wrapperNodes.forEach(function(e){e.classList.add(t.options.treeClass)})}),this.on(y,function(){t.wrapperNodes.forEach(function(e){e.classList.remove(t.options.treeClass)})}),e.MARKLIB_EVENTS||(e.MARKLIB_EVENTS=!0,function(){function t(e){var t=h["default"].getMarklibInstance(e);return t&&(t instanceof h["default"]||"wrapperNodes"in t)}function n(e){var n=v["default"].closestCallback(e.target,function(e){return t(e)});return"object"===("undefined"==typeof n?"undefined":a(n))?h["default"].getMarklibInstance(n):!1}function r(e,n){return v["default"].parentsCallback(e.target,function(e){return t(e)&&h["default"].getMarklibInstance(e)!==n}).map(function(e){return h["default"].getMarklibInstance(e)})}function i(){s.forEach(function(e){e.emit(T)}),s.clear(),l.forEach(function(e){e.emit(y)}),l.clear()}function o(e){var t=n(e);if(t){var a=r(e,t);if(e.target.textContent!==t.result.text&&a.length>0){var i=a;i.unshift(t),i=i.sort(function(e,t){return e.result.text.length<t.result.text.length?-1:1}),t=i[0]}return[t,a]}return!1}var s=new Set,l=new Set;e.addEventListener("click",function(e){var t=o(e);t&&t[0].emit(E,e,t[1])},!0),e.addEventListener("mouseover",function(e){var t=o(e);t?!function(){var n=u(t,2),r=n[0],a=n[1];i(),a.forEach(function(t){l.add(t),t.emit(g,e,a)}),r.emit(_,e,a),s.add(r)}():i()},!0)}())}},{key:"range",get:function(){var e=this.document.createRange(),t=[];if(this.wrapperNodes.forEach(function(e){v["default"].walkTextNodes(e,function(e){t.push(e)})}),t.length>0){var n=t[t.length-1];return e.setStart(t[0],0),e.setEnd(n,n.length),e}return null}}]),t}(c["default"]);t["default"]=N},,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),i=r(a),o=n(1),s=r(o),u=n(5),l=r(u),f=n(6),c=r(f);t["default"]={Rendering:i["default"],Util:s["default"],RenderResult:l["default"],RenderingEvents:c["default"]}},function(e,t,n){var r;(function(){"use strict";function t(){}function a(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function i(e){return function(){return this[e].apply(this,arguments)}}var o=t.prototype,s=this,u=s.EventEmitter;o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},o.addListener=function(e,t){var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===a(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=i("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=i("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&(n=a(i[r],t),-1!==n&&i[r].splice(n,1));return this},o.off=i("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,a,i=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)i.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(a=t[r])&&("function"==typeof a?i.call(this,r,a):o.call(this,r,a));return this},o.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},o.removeAllListeners=i("removeEvent"),o.emitEvent=function(e,t){var n,r,a,i,o,s=this.getListenersAsObject(e);for(i in s)if(s.hasOwnProperty(i))for(n=s[i].slice(0),a=n.length;a--;)r=n[a],r.once===!0&&this.removeListener(e,r.listener),o=r.listener.apply(this,t||[]),o===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=i("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},o._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return s.EventEmitter=u,t},r=function(){return t}.call(s,n,s,e),!(void 0!==r&&(e.exports=r))}).call(this)}])});
//# sourceMappingURL=marklib.min.map