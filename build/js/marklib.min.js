!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Marklib=e():t.Marklib=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="../",e(0)}([function(t,e,n){t.exports=n(60)},function(t,e){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(t,e){var n=t.exports={};"number"==typeof __e&&(__e=n)},function(t,e){"use strict";e["default"]=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e.__esModule=!0},function(t,e,n){"use strict";var r=n(49)["default"];e["default"]=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(t,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),e.__esModule=!0},function(t,e,n){var r=n(82)("wks"),i=n(8).Symbol;t.exports=function(t){return r[t]||(r[t]=i&&i[t]||(i||n(35))("Symbol."+t))}},function(t,e){"use strict";e["default"]=function(t){return t&&t.__esModule?t:{"default":t}},e.__esModule=!0},function(t,e,n){var r=n(8),i=n(2),o="prototype",a=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e,n){var u,l,c,f,d=t&s.G,h=t&s.P,v=d?r:t&s.S?r[e]:(r[e]||{})[o],p=d?i:i[e]||(i[e]={});d&&(n=e);for(u in n)l=!(t&s.F)&&v&&u in v,l&&u in p||(c=l?v[u]:n[u],d&&"function"!=typeof v[u]?f=n[u]:t&s.B&&l?f=a(c,r):t&s.W&&v[u]==c?!function(t){f=function(e){return this instanceof t?new t(e):t(e)},f[o]=t[o]}(c):f=h&&"function"==typeof c?a(Function.call,c):c,p[u]=f,h&&((p[o]||(p[o]={}))[u]=c))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,t.exports=s},function(t,e){var n="undefined"!=typeof self&&self.Math==Math?self:Function("return this")();t.exports=n,"number"==typeof __g&&(__g=n)},function(t,e,n){var r=n(1),i=n(44);t.exports=n(13)?function(t,e,n){return r.setDesc(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){t.exports={}},function(t,e,n){var r=n(16);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var r=n(51);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){t.exports=!n(39)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){t.exports={"default":n(70),__esModule:!0}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=function(t){return null!==t&&("object"==typeof t||"function"==typeof t)}},function(t,e,n){"use strict";var r=n(83)(!0);n(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(50)["default"];e["default"]=function(t,e,n){for(var i=!0;i;){var o=t,a=e,s=n;u=c=l=void 0,i=!1,null===o&&(o=Function.prototype);var u=r(o,a);if(void 0!==u){if("value"in u)return u.value;var l=u.get;return void 0===l?void 0:l.call(s)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=a,n=s,i=!0}},e.__esModule=!0},function(t,e,n){"use strict";var r=n(64)["default"],i=n(65)["default"];e["default"]=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=r(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(i?i(t,e):t.__proto__=e)},e.__esModule=!0},function(t,e,n){var r=n(29),i=n(5)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=(e=Object(t))[i])?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var r=n(12),i=n(53),o=n(52),a=n(11),s=n(57),u=n(36);t.exports=function(t,e,n,l){var c,f,d,h=u(t),v=r(n,l,e?2:1),p=0;if("function"!=typeof h)throw TypeError(t+" is not iterable!");if(o(h))for(c=s(t.length);c>p;p++)e?v(a(f=t[p])[0],f[1]):v(t[p]);else for(d=h.call(t);!(f=d.next()).done;)i(d,v,f.value,e)}},function(t,e,n){var r=n(30),i=n(9),o=n(5)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,e)}},function(t,e,n){n(87);var r=n(10);r.NodeList=r.HTMLCollection=r.Array},function(t,e,n){"use strict";var r=n(18)["default"],i=n(19)["default"],o=n(4)["default"],a=n(3)["default"],s=n(6)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=n(25),l=s(u),c=n(37),f=s(c),d=n(59),h=s(d),v="x-marker",p="data-original-offset-start";e.ATTR_DATA_ORIGINAL_OFFSET_START=p;var g="original-text-node-index",m="data-is-start-end",y="data-is-highlight-node",_="data-selection-id",E=16,b="wrapped-node";e.EVENT_WRAPPED_NODE=b;var T=function(t){function e(t,n,i){a(this,e),r(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,n,t),this.id=l["default"].guid(),this.startContainer=null,this.endContainer=null,this.context=i||this.document,this._renderResult=null}return i(e,t),o(e,[{key:"getId",value:function(){return this.id}},{key:"setId",value:function(t){var e=this;return this.id=t,this._renderResult&&this.wrapperNodes.forEach(function(t){return t.setAttribute(_,e.id)}),this}},{key:"_createWrapTemplate",value:function(t){var n=this.document.createElement(v),r="true";return t||(n.className=this.options.className.join(" "),e.setMarklibInstance(n,this),this.wrapperNodes.push(n),n.setAttribute(y,r),n.setAttribute(_,this.getId())),n.setAttribute(u.DATA_IS_SELECTION,r),n}},{key:"_createStartEndWrapTemplate",value:function(t){var e=this._createWrapTemplate(),n="true";return e.setAttribute(m,n),e.textContent=t,e}},{key:"_createStartOrEndContainer",value:function(t,e,n,r){var i=this._createStartEndWrapTemplate(e);return i.setAttribute(u.ATTR_DATA_ORIGINAL_INDEX,l["default"].getIndexParentIfHas(t,r)),i.setAttribute(p,n),i.setAttribute(g,r),i}},{key:"_createWrap",value:function(t,e,n,r,i){var o=n>=0?n:l["default"].calcIndex(t),a=this._createWrapTemplate(i);a.setAttribute(u.ATTR_DATA_ORIGINAL_INDEX,l["default"].getIndexParentIfHas(t,o));var s=e>=0?e:l["default"].getOffsetParentIfHas(t);a.setAttribute(p,s),a.setAttribute(g,o),r&&a.setAttribute(m,m);var c=l["default"].wrap(t,a);return this.emit(b,t,c),c}},{key:"_createSplitContainer",value:function(t,e,n){var r=this.document.createElement(v),i="true";return r.setAttribute(u.DATA_IS_SELECTION,i),r.setAttribute(u.ATTR_DATA_ORIGINAL_INDEX,l["default"].getIndexParentIfHas(t,e)),r.setAttribute(p,n),r.setAttribute(g,e),r}},{key:"walk",value:function(t,e,n){for(var r=t;r&&r!==n.parentNode;){var i=r;if(r=r.parentNode,this.wrapSiblings(i.nextSibling,e))break}}},{key:"wrapSiblings",value:function(t,n){for(var r=this,i=t,o=!1,a=function(t){var n=e.getMarklibInstance(t.parentNode);t.parentNode.hasAttribute(m)&&t.parentNode.hasAttribute(y)&&n===r?r._createWrap(t,void 0,void 0,void 0,!0):r._createWrap(t)}.bind(this),s=function(t){l["default"].nodeIsEmpty(t)||a(t)},u=function(t){return t===n?!1:(Node.TEXT_NODE===t.nodeType&&s(t),!0)},c=function(t){s(t)};null!==i&&i!==n;){var f=i;if(i=i.nextSibling,Node.TEXT_NODE===f.nodeType)s(f);else if(f.compareDocumentPosition(n)&E?(l["default"].walkDom(f,u),o=!0):l["default"].walkTextNodes(f,c),o)return!0}return o}},{key:"_markTextSameNode",value:function(t,e,n){var r=t.nodeValue,i=l["default"].calcIndex(t);if(!r)return!1;if(e>0){var o=r.slice(0,e);t.parentNode.insertBefore(this.document.createTextNode(o),t),l["default"].wrap(t.previousSibling,this._createSplitContainer(t,i,l["default"].getOffsetParentIfHas(t)))}if(n<r.length){var a=r.slice(n,r.length);t.parentNode.insertBefore(this.document.createTextNode(a),t.nextSibling),l["default"].wrap(t.nextSibling,this._createSplitContainer(t,i,l["default"].getOffsetParentIfHas(t)+n))}return t.nodeValue=r.slice(e,n),this.startContainer=this._createWrap(t,l["default"].getOffsetParentIfHas(t)+e,i,!0).parentNode,this.endContainer=this.startContainer,this.startContainer}},{key:"_markTextDifferentNode",value:function(t,e,n,r){var i=l["default"].calcIndex(t),o=l["default"].calcIndex(e),a=t.nodeValue,s=t;if(void 0!==a){var u=a.slice(n,a.length);t.nodeValue=a.slice(0,n);var c=l["default"].getOffsetParentIfHas(t);s=this._createStartOrEndContainer(t,u,c===n?c:c+n,i),t.parentNode.insertBefore(s,t.nextSibling),this.startContainer=s,t.nodeValue&&l["default"].wrap(t,this._createSplitContainer(t,i,l["default"].getOffsetParentIfHas(t)))}var f=e,d=e.nodeValue;if(void 0!==d){var h=d.slice(0,r);e.nodeValue=d.slice(r,d.length),f=this._createStartOrEndContainer(e,h,l["default"].getOffsetParentIfHas(e),o),e.parentNode.insertBefore(f,e),this.endContainer=f;var v=l["default"].getOffsetParentIfHas(e);l["default"].wrap(e,this._createSplitContainer(e,o,v===r?v:v+r))}return{startT:s,endT:f}}},{key:"_renderWithElements",value:function(t,e,n,r,i){if(this._renderResult)return this._renderResult;var o=l["default"].parents(t,n);o=o[o.length-1];var a=o?o:n,s=l["default"].findOriginalOffset(t),c=l["default"].findOriginalOffset(e);if(t.nodeType!==Node.TEXT_NODE&&e.nodeType!==Node.TEXT_NODE&&t===e&&(e=e.nextElementSibling||e),t.nodeType!==Node.TEXT_NODE&&l["default"].walkDom(t,function(e){return e.nodeType===Node.TEXT_NODE?(t=e,!1):!0}),e.nodeType!==Node.TEXT_NODE){var d=l["default"].closest(t,":not(["+u.DATA_IS_SELECTION+"])").childNodes;if(d.length){var h=d[d.length-1];if(h.nodeType===Node.TEXT_NODE)e=h,i=h.length;else for(var v=h.lastChild;null!==v;)v&&v.nodeType===Node.TEXT_NODE&&(e=v,i=v.length,v.parentNode.hasAttribute(p)&&(i=parseInt(v.parentNode.getAttribute(p))+i)),v=v.lastChild}if(e.nodeType!==Node.TEXT_NODE)throw"Could not found endContainer, highlighting would be unstable"}return this._renderResult=new f["default"](s+r,c+i,l["default"].getPath(t,this.context),l["default"].getPath(e,this.context)),this._renderResult.instance=this,this._renderSelection(t,e,r,i,a,!!o),this._renderResult}},{key:"_renderSelection",value:function(t,e,n,r,i,o){if(t===e)this._markTextSameNode(t,n,r);else{var a=this._markTextDifferentNode(t,e,n,r),s=this.wrapperNodes.indexOf(a.endT);this.wrapperNodes.splice(s,1),o?this.walk(a.startT,e,i):this.wrapSiblings(a.startT.nextSibling,e),this.wrapperNodes.push(a.endT)}}},{key:"renderWithPath",value:function(t,e){var n=l["default"].deserializePath(t,this.context),r=l["default"].deserializePath(e,this.context);if(n&&r&&n.node&&r.node){var i=document.createRange();i.setStart(n.node,n.offset),i.setEnd(r.node,r.offset);var o=i.toString(),a=this.renderWithRange(i);return a.text=o,o}throw"Could not find start- and/or end-container in document"}},{key:"renderWithResult",value:function(t){return this.renderWithPath(t.startContainerPath+";"+t.startOffset,t.endContainerPath+";"+t.endOffset)}},{key:"renderWithRange",value:function(t){var e=t.toString(),n=this._renderWithElements(t.startContainer,t.endContainer,t.commonAncestorContainer,t.startOffset,t.endOffset);return n.text=e,n}},{key:"destroy",value:function(){this.wrapperNodes.forEach(function(t){delete t.marklibInstance,t.className=""}),this.removeEvent()}},{key:"result",get:function(){return this._renderResult}}],[{key:"setMarklibInstance",value:function(t,e){return t.marklibInstance=e,t}},{key:"getMarklibInstance",value:function(t){return t?t.marklibInstance:null}}]),e}(h["default"]);e["default"]=T},function(t,e,n){"use strict";var r=n(4)["default"],i=n(3)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=n(24),a="data-original-index";e.ATTR_DATA_ORIGINAL_INDEX=a;var s="data-is-pseudo";e.DATA_PSEUDO=s;var u="data-is-selection";e.DATA_IS_SELECTION=u;var l=";";if(Element&&!Element.prototype.matches){var c=Element.prototype;c.matches=c.matchesSelector||c.mozMatchesSelector||c.msMatchesSelector||c.oMatchesSelector||c.webkitMatchesSelector}var f=function(){function t(){i(this,t)}return r(t,null,[{key:"nodeListFilter",value:function(t,e){return Array.prototype.filter.call(t||[],e)}},{key:"guid",value:function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}},{key:"nodeIsEmpty",value:function(t){return t.nodeValue.match(/^[\s]*$/g)}},{key:"index",value:function(t,e){var n=e||(t.nodeType===Node.TEXT_NODE?t.parentNode.childNodes:t.parentNode.children);return Array.prototype.indexOf.call(n||[],t)}},{key:"wrap",value:function(t,e){if(!t)return e;t instanceof NodeList||t instanceof Array||(t=[t]);for(var n=t.length-1;n>=0;n--){var r=n>0?e.cloneNode(!0):e,i=t[n],o=i.parentNode,a=i.nextSibling;r.appendChild(i),a?o.insertBefore(r,a):o.appendChild(r)}return e}},{key:"calcIndex",value:function(e){for(var n=0,r=!1,i=e.parentNode.childNodes,o=i.length,s=0;o>s;s++){var u=i[s];if(u===e)break;var l=u.getAttribute?u.getAttribute(a):null;l&&(n=parseInt(l),r=!0),n++}return r?n:t.index(e)}},{key:"parents",value:function(e,n){return t.parentsCallback(e,function(t){return n&&(t===n||"string"==typeof n&&t.matches&&t.matches(n))?!0:n?!1:!0})}},{key:"parentsCallback",value:function(t,e){for(var n=t,r=[];null!==n.parentNode;)n=n.parentNode,e(n)&&r.push(n);return r}},{key:"parent",value:function(t,e){for(var n=t;null!==n.parentNode;)if(n=n.parentNode,n.matches&&n.matches(e))return n;return!1}},{key:"closest",value:function(e,n){return t.closestCallback(e,function(t){return t.matches&&t.matches(n)})}},{key:"closestCallback",value:function(t,e){for(var n=t;null!==n;){if(e(n))return n;n=n.parentNode}return!1}},{key:"outerMostCallback",value:function(t,e){for(var n=t,r=!1;null!==n;)e(n)&&(r=n),n=n.parentNode;return r}},{key:"isMarkNode",value:function(t){return t instanceof HTMLElement&&t.hasAttribute(u)}},{key:"getPath",value:function(e,n){for(var r=null,i=e,o=function(e){return!t.isMarkNode(e)&&e.nodeName===i.nodeName};i;){var s=null;if(Node.TEXT_NODE===i.nodeType){var u=t.parents(i,"["+a+"]").reverse()[0],c=0;u||(c=t.calcIndex(i));var f=u?parseInt(u.getAttribute(a)):c;s=l+f}else s=i.nodeName;if(!s)break;s=s.toLowerCase();var d=i.parentNode;if(t.isMarkNode(i)){if(d!==n){i=d;continue}break}var h=t.nodeListFilter(d.children,o),v=t.index(i,h);if(h.length>1&&v>=0&&(s+=":nth-of-type("+(v+1)+")"),r=s+(r?">"+r:""),d===n)break;i=d}return r.replace("#document>","").replace(">;",";")}},{key:"findOriginalOffset",value:function(e){if(!e.parentNode.hasAttribute(o.ATTR_DATA_ORIGINAL_OFFSET_START))return 0;var n=t.parent(e,"["+o.ATTR_DATA_ORIGINAL_OFFSET_START+"]");return n?parseInt(n.getAttribute(o.ATTR_DATA_ORIGINAL_OFFSET_START)):0}},{key:"deserializePath",value:function(e,n){var r=e.split(";"),i=r[0],s=parseInt(r[1]),u=parseInt(r[2]),l=i.trim()?n.querySelector(i):n,c=null;return t.walkDom(l,function(e){if(e.nodeType!==Node.TEXT_NODE)return!0;var n=e.parentNode.getAttribute(o.ATTR_DATA_ORIGINAL_OFFSET_START);n=null===n?0:n;var r=e.parentNode.getAttribute(a);if(r=null===r?t.calcIndex(e):r,parseInt(r)===s&&u>=n&&parseInt(n)+e.length>=u){var i=e.parentNode.hasAttribute(o.ATTR_DATA_ORIGINAL_OFFSET_START)?u-parseInt(e.parentNode.getAttribute(o.ATTR_DATA_ORIGINAL_OFFSET_START)):u;return c={node:e,offset:i},!1}return!0}),c}},{key:"walkDom",value:function(e,n){if(!e)return!1;var r=e.childNodes;if(!r)return!1;for(var i=0;i<r.length;i++)if(!t.walkDom(r[i],n))return!1;return n(e)}},{key:"walkTextNodes",value:function(e,n){t.walkDom(e,function(e){return Node.TEXT_NODE!==e.nodeType||t.nodeIsEmpty(e)||n(e),!0})}},{key:"getIndexParentIfHas",value:function(t,e){var n=t.parentNode,r=parseInt(n.getAttribute(a));return r>e?r:e}},{key:"getOffsetParentIfHas",value:function(t){var e=t.parentNode,n=parseInt(e.getAttribute(o.ATTR_DATA_ORIGINAL_OFFSET_START));return n>0?n:0}}]),t}();e["default"]=f},,,,function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var r=n(54),i=n(7),o=n(45),a=n(9),s=n(30),u=n(5)("iterator"),l=n(10),c="@@iterator",f="keys",d="values",h=function(){return this};t.exports=function(t,e,v,p,g,m,y){n(81)(v,e,p);var _,E,b=function(t){switch(t){case f:return function(){return new v(this,t)};case d:return function(){return new v(this,t)}}return function(){return new v(this,t)}},T=e+" Iterator",O=t.prototype,k=O[u]||O[c]||g&&O[g],x=k||b(g);if(k){var C=n(1).getProto(x.call(new t));n(22)(C,T,!0),!r&&s(O,c)&&a(C,u,h)}if((!r||y)&&a(O,u,x),l[e]=x,l[T]=h,g)if(_={keys:m?x:b(f),values:g==d?x:b(d),entries:g!=d?x:b("entries")},y)for(E in _)E in O||o(O,E,_[E]);else i(i.P+i.F*n(41),e,_)}},function(t,e,n){var r=n(45);t.exports=function(t,e){for(var n in e)r(t,n,e[n]);return t}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError(n+": use the 'new' operator!");return t}},function(t,e,n){var r=n(40),i=n(15);t.exports=function(t){return r(i(t))}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){var r=n(20),i=n(5)("iterator"),o=n(10);t.exports=n(2).getIteratorMethod=function(t){return void 0!=t?t[i]||t["@@iterator"]||o[r(t)]:void 0}},function(t,e,n){"use strict";var r=n(4)["default"],i=n(3)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(e,n,r,o){i(this,t),this.startOffset=e,this.endOffset=n,this.startContainerPath=r,this.endContainerPath=o,this._renderingInstance=null}return r(t,[{key:"serialize",value:function(){return{startOffset:this.startOffset,endOffset:this.endOffset,startContainerPath:this.startContainerPath,endContainerPath:this.endContainerPath}}},{key:"text",set:function(t){this._text=t},get:function(){return this._text}},{key:"instance",get:function(){return this._renderingInstance},set:function(t){this._renderingInstance=t}}],[{key:"fromObject",value:function(e){return new t(e.startOffset,e.endOffset,e.startContainerPath,e.endContainerPath)}}]),t}();e["default"]=o,t.exports=e["default"]},,function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e,n){var r=n(29);t.exports=0 in Object("z")?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){t.exports="keys"in[]&&!("next"in[].keys())},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){t.exports=function(t,e){var r=n(7),i=(n(2).Object||{})[t]||Object[t],o={};o[t]=e(i),r(r.S+r.F*n(39)(function(){i(1)}),"Object",o)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){t.exports=n(9)},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(15);t.exports=function(t){return Object(r(t))}},,function(t,e,n){t.exports={"default":n(72),__esModule:!0}},function(t,e,n){t.exports={"default":n(73),__esModule:!0}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(10),i=n(5)("iterator");t.exports=function(t){return(r.Array||Array.prototype[i])===t}},function(t,e,n){var r=n(11);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(o){var a=t["return"];throw void 0!==a&&r(a.call(t)),o}}},function(t,e){t.exports=!0},function(t,e,n){var r=n(1).getDesc,i=n(16),o=n(11),a=function(t,e){if(o(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e){try{e=n(12)(Function.call,r(Object.prototype,"__proto__").set,2),e({},[])}catch(i){t=!0}return function(n,r){return a(n,r),t?n.__proto__=r:e(n,r),n}}():void 0),check:a}},function(t,e,n){"use strict";var r=n(1),i=n(5)("species");t.exports=function(t){!n(13)||i in t||r.setDesc(t,i,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(46),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){},function(t,e,n){"use strict";var r=n(18)["default"],i=n(19)["default"],o=n(4)["default"],a=n(3)["default"],s=n(67)["default"],u=n(14)["default"],l=n(66)["default"],c=n(6)["default"];Object.defineProperty(e,"__esModule",{value:!0});var f=n(93),d=c(f),h=n(24),v=c(h),p=n(25),g=c(p),m="click";e.EVENT_CLICK=m;var y="hover-enter";e.EVENT_MOUSEENTER=y;var _="hover-leave";e.EVENT_MOUSELEAVE=_;var E="tree-enter";e.EVENT_PART_TREE_ENTER=E;var b="tree-leave";e.EVENT_PART_TREE_LEAVE=b;var T=function(t){function e(t,n){a(this,e),r(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.options={hoverClass:"marklib--hover",treeClass:"marklib--tree",className:["marking"]},this.options=u(this.options,t||{}),"string"==typeof this.options.className&&(this.options.className=this.options.className.split(" ")),this.wrapperNodes=[],this._registerEvents(n),this.document=n}return i(e,t),o(e,[{key:"_registerEvents",value:function(t){var e=this;this.on(y,function(){e.wrapperNodes.forEach(function(t){t.classList.add(e.options.hoverClass)})}),this.on(_,function(){e.wrapperNodes.forEach(function(t){t.classList.remove(e.options.hoverClass)})}),this.on(E,function(){e.wrapperNodes.forEach(function(t){t.classList.add(e.options.treeClass)})}),this.on(b,function(){e.wrapperNodes.forEach(function(t){t.classList.remove(e.options.treeClass)})}),t.MARKLIB_EVENTS||(t.MARKLIB_EVENTS=!0,function(){function e(t){var e=v["default"].getMarklibInstance(t);return e&&(e instanceof v["default"]||"wrapperNodes"in e)}function n(t){var n=g["default"].closestCallback(t.target,function(t){return e(t)});return"object"==typeof n?v["default"].getMarklibInstance(n):!1}function r(t,n){return g["default"].parentsCallback(t.target,function(t){return e(t)&&v["default"].getMarklibInstance(t)!==n}).map(function(t){return v["default"].getMarklibInstance(t)})}function i(){a.forEach(function(t){t.emit(_)}),a.clear(),u.forEach(function(t){t.emit(b)}),u.clear()}function o(t){var e=n(t);if(e){var i=r(t,e);if(t.target.textContent!==e.result.text&&i.length>0){var o=i;o.unshift(e),o=o.sort(function(t,e){return t.result.text.length<e.result.text.length?-1:1}),e=o[0]}return[e,i]}return!1}var a=new l,u=new l;t.addEventListener("click",function(t){var e=o(t);e&&e[0].emit(m,t,e[1])},!0),t.addEventListener("mouseover",function(t){var e=o(t);e?!function(){var n=s(e,2),r=n[0],o=n[1];i(),o.forEach(function(e){u.add(e),e.emit(E,t,o)}),r.emit(y,t,o),a.add(r)}():i()},!0)}())}},{key:"range",get:function(){var t=this.document.createRange(),e=[];if(this.wrapperNodes.forEach(function(t){g["default"].walkTextNodes(t,function(t){e.push(t)})}),e.length>0){var n=e[e.length-1];return t.setStart(e[0],0),t.setEnd(n,n.length),t}return null}}]),e}(d["default"]);e["default"]=T},function(t,e,n){"use strict";var r=n(6)["default"];Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i),a=n(25),s=r(a),u=n(37),l=r(u);e["default"]={Rendering:o["default"],Util:s["default"],RenderResult:l["default"]},t.exports=e["default"]},,function(t,e,n){t.exports={"default":n(68),__esModule:!0}},function(t,e,n){t.exports={"default":n(69),__esModule:!0}},function(t,e,n){t.exports={"default":n(71),__esModule:!0}},function(t,e,n){t.exports={"default":n(74),__esModule:!0}},function(t,e,n){t.exports={"default":n(75),__esModule:!0}},function(t,e,n){"use strict";var r=n(62)["default"],i=n(63)["default"];e["default"]=function(){function t(t,e){var n=[],i=!0,o=!1,a=void 0;try{for(var s,u=r(t);!(i=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(l){o=!0,a=l}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(i(Object(e)))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e.__esModule=!0},function(t,e,n){n(23),n(17),t.exports=n(85)},function(t,e,n){n(23),n(17),t.exports=n(86)},function(t,e,n){n(88),t.exports=n(2).Object.assign},function(t,e,n){var r=n(1);t.exports=function(t,e){return r.create(t,e)}},function(t,e,n){var r=n(1);t.exports=function(t,e,n){return r.setDesc(t,e,n)}},function(t,e,n){var r=n(1);n(89),t.exports=function(t,e){return r.getDesc(t,e)}},function(t,e,n){n(90),t.exports=n(2).Object.setPrototypeOf},function(t,e,n){n(58),n(17),n(23),n(91),n(92),t.exports=n(2).Set},function(t,e,n){var r=n(47),i=n(40),o=n(80);t.exports=Object.assign||function(t,e){for(var n=r(t),a=arguments.length,s=1;a>s;)for(var u,l=i(arguments[s++]),c=o(l),f=c.length,d=0;f>d;)n[u=c[d++]]=l[u];return n}},function(t,e,n){"use strict";var r=n(1),i=n(9),o=n(12),a=n(56),s=n(33),u=n(15),l=n(21),c=n(42),f=n(35)("id"),d=n(30),h=n(16),v=Object.isExtensible||h,p=n(13),g=p?"_s":"size",m=0,y=function(t,e){if(!h(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!d(t,f)){if(!v(t))return"F";if(!e)return"E";i(t,f,++m)}return"O"+t[f]},_=function(t,e){var n,r=y(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,i,a){var c=t(function(t,n){s(t,c,e),t._i=r.create(null),t._f=void 0,t._l=void 0,t[g]=0,void 0!=n&&l(n,i,t[a],t)});return n(32)(c.prototype,{clear:function(){for(var t=this,e=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete e[n.i];t._f=t._l=void 0,t[g]=0},"delete":function(t){var e=this,n=_(e,t);if(n){var r=n.n,i=n.p;delete e._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),e._f==n&&(e._f=r),e._l==n&&(e._l=i),e[g]--}return!!n},forEach:function(t){for(var e,n=o(t,arguments[1],3);e=e?e.n:this._f;)for(n(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!_(this,t)}}),p&&r.setDesc(c.prototype,"size",{get:function(){return u(this[g])}}),c},def:function(t,e,n){var r,i,o=_(t,e);return o?o.v=n:(t._l=o={i:i=y(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[g]++,"F"!==i&&(t._i[i]=o)),t},getEntry:_,setStrong:function(t,e,r){n(31)(t,e,function(t,e){this._t=t,this._k=e,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?c(0,n.k):"values"==e?c(0,n.v):c(0,[n.k,n.v]):(t._t=void 0,c(1))},r?"entries":"values",!r,!0),a(t),a(n(2)[e])}}},function(t,e,n){var r=n(21),i=n(20);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");var e=[];return r(this,!1,e.push,e),e}}},function(t,e,n){"use strict";var r=n(1),i=n(7),o=n(9),a=n(41),s=n(21),u=n(33);t.exports=function(t,e,l,c,f,d){var h=n(8)[t],v=h,p=f?"set":"add",g=v&&v.prototype,m={};return n(13)&&"function"==typeof v&&(d||!a&&g.forEach&&g.entries)?(v=e(function(e,n){u(e,v,t),e._c=new h,void 0!=n&&s(n,f,e[p],e)}),r.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),function(t){var e="add"==t||"set"==t;t in g&&(!d||"clear"!=t)&&o(v.prototype,t,function(n,r){var i=this._c[t](0===n?0:n,r);return e?this:i})}),"size"in g&&r.setDesc(v.prototype,"size",{get:function(){return this._c.size}})):(v=c.getConstructor(e,t,f,p),n(32)(v.prototype,l)),n(22)(v,t),m[t]=v,i(i.G+i.W+i.F,m),d||c.setStrong(v,t,f),v}},function(t,e,n){var r=n(1);t.exports=function(t){var e=r.getKeys(t),n=r.getSymbols;if(n)for(var i,o=n(t),a=r.isEnum,s=0;o.length>s;)a.call(t,i=o[s++])&&e.push(i);return e}},function(t,e,n){"use strict";var r=n(1),i={};n(9)(i,n(5)("iterator"),function(){return this}),t.exports=function(t,e,o){t.prototype=r.create(i,{next:n(44)(1,o)}),n(22)(t,e+" Iterator")}},function(t,e,n){var r=n(8),i="__core-js_shared__",o=r[i]||(r[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,n){var r=n(46),i=n(15);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),l=s.length;return 0>u||u>=l?t?"":void 0:(o=s.charCodeAt(u),55296>o||o>56319||u+1===l||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):(o-55296<<10)+(a-56320)+65536)}}},function(t,e){t.exports=function(){}},function(t,e,n){var r=n(11),i=n(36);t.exports=n(2).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},function(t,e,n){var r=n(20),i=n(5)("iterator"),o=n(10);t.exports=n(2).isIterable=function(t){var e=Object(t);return i in e||"@@iterator"in e||o.hasOwnProperty(r(e))}},function(t,e,n){"use strict";var r=n(84),i=n(42),o=n(10),a=n(34);n(31)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,n):"values"==e?i(0,t[n]):i(0,[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){var r=n(7);r(r.S,"Object",{assign:n(76)})},function(t,e,n){var r=n(34);n(43)("getOwnPropertyDescriptor",function(t){return function(e,n){return t(r(e),n)}})},function(t,e,n){var r=n(7);r(r.S,"Object",{setPrototypeOf:n(55).set})},function(t,e,n){"use strict";var r=n(77);n(79)("Set",function(t){return function(){return t(this,arguments[0])}},{add:function(t){return r.def(this,t=0===t?0:t,t)}},r)},function(t,e,n){var r=n(7);r(r.P,"Set",{toJSON:n(78)("Set")})},function(t,e,n){var r;(function(){"use strict";function e(){}function i(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function o(t){return function(){return this[t].apply(this,arguments)}}var a=e.prototype,s=this,u=s.EventEmitter;a.getListeners=function(t){var e,n,r=this._getEvents();if(t instanceof RegExp){e={};for(n in r)r.hasOwnProperty(n)&&t.test(n)&&(e[n]=r[n])}else e=r[t]||(r[t]=[]);return e},a.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},a.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},a.addListener=function(t,e){var n,r=this.getListenersAsObject(t),o="object"==typeof e;for(n in r)r.hasOwnProperty(n)&&-1===i(r[n],e)&&r[n].push(o?e:{listener:e,once:!1});return this},a.on=o("addListener"),a.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},a.once=o("addOnceListener"),a.defineEvent=function(t){return this.getListeners(t),this},a.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},a.removeListener=function(t,e){var n,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&(n=i(o[r],e),-1!==n&&o[r].splice(n,1));return this},a.off=o("removeListener"),a.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},a.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},a.manipulateListeners=function(t,e,n){var r,i,o=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(r=n.length;r--;)o.call(this,e,n[r]);else for(r in e)e.hasOwnProperty(r)&&(i=e[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},a.removeEvent=function(t){var e,n=typeof t,r=this._getEvents();if("string"===n)delete r[t];else if(t instanceof RegExp)for(e in r)r.hasOwnProperty(e)&&t.test(e)&&delete r[e];else delete this._events;return this},a.removeAllListeners=o("removeEvent"),a.emitEvent=function(t,e){var n,r,i,o,a=this.getListenersAsObject(t);for(i in a)if(a.hasOwnProperty(i))for(r=a[i].length;r--;)n=a[i][r],n.once===!0&&this.removeListener(t,n.listener),o=n.listener.apply(this,e||[]),o===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},a.trigger=o("emitEvent"),a.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},a.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},a._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},a._getEvents=function(){return this._events||(this._events={});
},e.noConflict=function(){return s.EventEmitter=u,e},r=function(){return e}.call(s,n,s,t),!(void 0!==r&&(t.exports=r))}).call(this)}])});
//# sourceMappingURL=marklib.min.map